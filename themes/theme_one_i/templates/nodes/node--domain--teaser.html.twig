{# @see oab_modular_product_preprocess_paragraph__module_domains() #}
{% set variation = node.module_variation ?? 'default' %}
{% set logo = content.field_logo.0 %}
{% set title = content.field_teaser_title.0 %}
{% set text = content.field_teaser.0 %}
{% set link = {
    url: path('entity.node.canonical', {'node': node.id() }),
    title: 'Read more'|t
} %}
{% set utag = {
  titre_page: utag_data.titre_page,
  module_title: node.module_title,
  title: node.label(),
  text: link.title
} %}

{%
  set classes = [
    'd-flex',
    'flex-column',
    variation == 'link' ? 'justify-content-center' : 'justify-content-between',
    'w-100',
    'p-2',
    'bg-greige',
    'text-break',
    'fullclick',
    'node--type--' ~ bundle|clean_class,
    'node--view-mode--' ~ view_mode|clean_class,
    'variation--' ~ variation|clean_class,
    'domain-card',
  ]
%}

{%
  set top_classes = [
    'd-flex',
    variation == 'link' ? 'flex-row' : 'flex-column',
    variation == 'link' ? 'align-items-center',
    'domain-card__top',
  ]
%}

{%
  set logo_classes = [
    variation == 'link' ? 'pr-md-2' : 'pb-2',
    'domain-card__logo'
  ]
%}

{%
  set lead_classes = [
    'lead',
    variation != 'link' ? 'pb-2',
    'domain-card__title'
  ]
%}

<section{{attributes.addClass(classes)}}>
	<div class="{{ top_classes|join(' ') }}">
		{% if logo|length %}
			<div class="{{ logo_classes|join(' ') }}">
				{{ logo }}
			</div>
		{% endif %}

		{% if title|length %}
			{% if variation == 'link' %}
				<a class="{{ lead_classes|join(' ') }}" href="{{ link.url }}" onmousedown="utag_link({{ utag.titre_page }}, '{{ utag.module_title }}', '{{ utag.title }}', '{{ utag.text }}');">
					<strong>{{ title|render|slice(0, 70) }}</strong>
				</a>
			{% else %}
				<div class="h3 m-0 pb-2 domain-card__title">
					{{ title }}
				</div>
			{% endif %}
		{% endif %}

		{% if variation == 'default' %}
			{% if text|length %}
				<div class="pb-2 domain-card__text">
					{{ text }}
				</div>
			{% endif %}
		{% endif %}
	</div>

	{% if variation == 'default' %}
		{% if text|length %}
			<div class="d-flex flex-column justify-content-end domain-card__bottom">
				<div class="pt-2 domain-card__link">
					<a class="o-link-arrow" href="{{ link.url }}" onmousedown="utag_link({{ utag.titre_page }}, '{{ utag.module_title }}', '{{ utag.title }}', '{{ utag.text }}');">
						{{ link.title }}
					</a>
				</div>
			</div>
		{% endif %}
	{% endif %}
</section>
